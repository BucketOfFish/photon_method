#include "../../Common/Settings.C"

void deconvolution_test() {
    // bin 1
    //vector<float> Z_METl_large{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00520121, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.19988, 0, 0, 0, 0.00552791, 0, 0.241769, 0.00610453, 0, 0, 0, 0.00535051, 0.0127791, 0.0214806, 0, 0, 0, 0, 0, 0, 0.0364271, 0.0199288, 0.00626074, 0.0429909, 0.0397736, 0.0169213, 0.0383945, 1.24778, 0.0657117, 0.0853286, 0, 0.491471, 0.688203, 11.5536, 3.62549, 30.5126, 0, 14.9569, 42.1265, 48.6353, 115.3, 232.626, 521.346, 764.067, 1243.49, 2559.58, 3980.05, 6888.85, 12337.9, 21450.2, 34860.9, 53243.3, 62906.2, 59030.7, 43519.8, 28592.7, 17212.6, 11345.9, 6859.46, 3885.74, 0, 1261.65, 558.561, 384.013, 179.348, 104.253, 37.2861, 0, 16.0582, 8.1917, 1.6601, 21.2337, 3.63455, 0.155838, 0.482652, 0, 0.442619, 0.422832, 0.0729531, 0, 0.0162558, 0.0475612, 0.0172573, 0, 0.0051579, 0.0335496, 0.0159264, 0.0133068, 0.00925592, 0.0107421, 0.00585721, 12.3625, 0, 0.00535439, 0.00424894, 0, 0.00536477, 0, 0, 0.00620688, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00355462, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    //vector<float> g_METl_large{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00289383, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.340071, 251.18, 0, 0.417147, 0, 346.209, 415.61, 0.898001, 219.419, 475.759, 1266.95, 2046.3, 3482.4, 2671.39, 7207.68, 14710.8, 18367.7, 28245.7, 31517.2, 63466.6, 107514, 130618, 172951, 193249, 174039, 158571, 120572, 80463.8, 70380.1, 38469.9, 30401.1, 11215.6, 7648.53, 6125.93, 2462.47, 0, 1577.18, 284.516, 18.1267, 0, 0.353801, 1.46938, 1.81872, 0, 0.00287793, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00171555, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

    // bin 5
    //vector<float> Z_METl_large{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0054615, 0, 0, 0, 0, 0, 0, 0, 0.00385503, 0, 0, 0, 0.0152211, 0, 0, 0, 0.00575307, 0.00598729, 0.00564705, 0, 0, 0.00535721, 0, 0.0175233, 0, 0.00584722, 0.0105968, 0.0342271, 0.0455537, 0.0336813, 0.0811147, 0.139655, 0.308888, 0.533336, 0.180245, 1.0261, 4.67146, 0.865944, 4.3693, 9.47544, 4.27995, 44.8131, 69.7381, 121.641, 249.35, 402.04, 960.643, 1460.76, 3137.26, 4710.25, 6982.06, 9691.49, 11777, 10980.1, 9299.41, 6845.54, 4335.81, 2371.09, 1287.49, 591.04, 336.016, 165.472, 107.112, 32.8081, 12.9042, 44.6396, 11.6375, 4.51229, 0, 0, 0, 0, 2.96923, 0.0872676, 0.44319, 0.0404869, 0.0427218, 0, 0.0191706, 0, 0.0102325, 0.0114283, 0.0052066, 0.012467, 0, 0, 0.00431562, 0, 0, 0.00694141, 0, 0, 0, 0.0041888, 0, 0, 0.0194004, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    //vector<float> g_METl_large{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 685.105, 0, 444.344, 131.335, 928.767, 0, 5438.02, 8278.46, 11460, 14607.1, 44856.3, 66277.6, 125717, 180265, 351125, 613417, 943075, 1.366e+06, 1.87933e+06, 2.72679e+06, 3.89857e+06, 4.97771e+06, 5.84913e+06, 5.60947e+06, 4.54298e+06, 3.2886e+06, 1.97981e+06, 1.15727e+06, 620668, 320767, 177851, 79794, 55740, 21072.4, 16292.9, 5568.84, 4310.54, 2230.99, 1583.59, 286.426, 32.8701, 1.47555, 427.573, 0, 24.434, 0, 153.827, 2299.61, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

    // bin 21
    //vector<float> Z_METl_large{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00430267, 0, 0, 0.00591962, 0.00596601, 0, 0, 0, 0.00624066, 0.00504468, 0.00495326, 0.0107595, 0, 0, 0.00682338, 0, 0, 0.0520384, 0, 0.0104772, 0.12521, 0, 0.00551414, 0.0135071, 0.0853069, 0.00252874, 0.0411571, 0.060444, 0.0718789, 0.0938239, 0.111526, 0.331922, 0.0940803, 0.00733013, 0, 1.80296, 0.630309, 0.27927, 0.487515, 2.16746, 0.887519, 1.55247, 2.78023, 3.18469, 4.1531, 5.33494, 8.86151, 11.9254, 17.4228, 27.4537, 38.2397, 49.9931, 74.0411, 114.518, 143.245, 189.546, 234.73, 262.658, 299.828, 324.802, 320.685, 292.027, 263.45, 224.43, 189.945, 143.098, 101.386, 79.3426, 50.3988, 38.0766, 23.903, 17.3257, 10.4859, 6.39779, 5.85631, 3.16413, 2.75728, 1.12008, 1.35415, 0.873461, 0.710496, 0.636064, 0.492206, 0.259494, 0.133019, 0.146182, 0.117631, 0.191141, 0.0903314, 0.0133783, 0.0817728, 0.248585, 0.0660639, 0.096407, 0.0353221, 0.0185278, 0.041603, 0, 0.0163382, 0.0164479, 0.0664943, 0, 0.0366065, 0.0367308, 0.0166117, 0, 0.00511676, 0.0300576, 0.0317661, 0.0200391, 0.0164836, 0.0302237, 0.0124819, 0, 0, 0.0649357, 0, 0.00262746, 0, 0, 0.0101708, 0.00565577, 0.0451138, 0.0334266, 0.0128785, 0, 0, 0, 0.00504524, 0, 0, 0.00944934, 0, 0.00563293, 0, 0, 0, 0, 0.0062931, 0, 0, 0.00570906, 0.00567941, 0, 0, 0, 0, 0, 0, 0, 0.00551897, 0, 0, 0, 0, 0, 0, 0, 0.00788074, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00753661, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    //vector<float> g_METl_large{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0308088, 0, 0, 0, 0.358203, 0, 0, 0, 0.358648, 0, 0.224438, 0.645218, 0, 1.14622, 0.782682, 0.34388, 0.40173, 0.705905, 2.31387, 1.36475, 0.38212, 0.527657, 1.65267, 0.297702, 1.4899, 1.67559, 0.431231, 0.985773, 1.71745, 1.57449, 1.34667, 0.171885, 2.39836, 2.15443, 2.70481, 1.99991, 2.58494, 5.55761, 4.70876, 1.53486, 4.30247, 3.52909, 6.39913, 6.89041, 2.10433, 5.47733, 6.51673, 8.30641, 8.667, 11.0114, 14.326, 7.60473, 7.14277, 15.8888, 16.2913, 15.936, 25.6622, 23.5149, 36.4218, 30.9691, 48.2445, 52.2945, 77.1821, 82.0309, 140.825, 187.277, 249.306, 334.709, 536.463, 817.374, 1328.97, 1976.77, 2934.31, 4391.82, 6005.43, 8360.87, 7581.08, 13276.7, 14399.6, 14840.2, 14115.7, 12683.5, 10608.4, 8033.33, 5723.35, 4086.42, 3171.13, 1725.35, 1122.2, 1114.5, 436.446, 714.274, 181.54, 111.34, 86.0017, 49.3911, 37.854, 28.5014, 15.0605, 24.0263, 9.4332, 5.88777, 5.40775, 3.1028, 2.32021, 1.67486, 0.449441, 1.77776, 0.471858, 0.728364, 1.15173, 0, 0, 0.0407694, 0.610268, 0, 0, 0, 0, 0, 0.342134, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

    // bin 23
    //vector<float> Z_METl_large{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0967026, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0113522, 0, 0, 0, 0.163276, 0.00190866, 0, 0.0346957, 0, 0.05369, 0, 0.0994209, 0, 0, 0, 0.112386, 0.00683289, 0.026116, 0.0210817, 0, 0.0253661, 0.0426773, 0, 0.0548633, 0.00290415, 0.0385704, 0.0227879, 0.0553114, 0.129752, 0, 0.00500546, 0.129936, 0.145464, 0.125752, 0.228075, 0, 0.17591, 0.241921, 0.0690944, 0.255028, 0.0211066, 0, 0.105437, 0.391158, 0.268866, 0.280561, 0.261604, 0.399415, 0.508596, 0.518588, 0.551512, 0.61839, 0.447208, 1.20389, 0.993928, 1.09167, 0.903035, 1.1159, 1.09174, 1.50501, 1.68869, 2.19203, 1.96879, 2.98209, 2.77828, 2.99655, 3.67143, 5.7882, 3.76815, 6.33023, 7.16212, 7.6706, 8.21592, 10.322, 11.3957, 12.9353, 14.3976, 16.4664, 18.5771, 19.7844, 21.7814, 24.6853, 25.8031, 28.3653, 28.4609, 29.193, 29.5519, 30.4939, 28.53, 27.5052, 24.6936, 24.2702, 22.5175, 21.2282, 20.0875, 15.1764, 13.346, 10.5389, 10.1779, 7.78657, 7.3302, 5.27522, 4.91867, 4.06493, 3.06001, 2.95382, 2.6215, 1.47669, 1.30379, 1.27228, 1.01428, 1.06293, 0.860822, 0.533846, 0.602999, 0.502646, 0.612799, 0.341948, 0.268466, 0.252495, 0.103397, 0.14713, 0.0904009, 0.150222, 0.17692, 0.0514984, 0.000920465, 0.0976227, 0.121238, 0.0758987, 0.0610905, 0.0517664, 0.0224804, 0.0416511, 0.0279213, 0.0328519, 0.0455732, 0.0320397, 0.0047556, 0.0235896, 0.0244503, 0.0154168, 0.0190928, 0, 0.00943185, 0, 0.0112589, 0.0110722, 0.00615823, 0, 0.0116893, 0.00642929, 0.00832224, 0.0104763, 0.00463335, 0.00204109, 0, 0, 0, 0, 0, 0.00414311, 0, 0, 0, 0, 0, 0.00749129, 0, 0, 0, 0, 0.0038273, 0.0100406, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    //vector<float> g_METl_large{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0823029, 0, 0, 0, 0, 0, 0.101915, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0731538, 0, 0.0706865, 0, 0, 0, 0, 0, 0.0645096, 0, 0, 0, 0, 0, 0, 0.0790853, 0.11554, 0, 0.108533, 0.00383873, 0, 0, 0.118615, 0, 0.0651082, 0, 0.0438358, 0, 0.447515, 0, 0.074741, 0, 0, 0.175035, 0, 0, 0.0694565, 0.187531, 0.351661, 0.0378096, 0, 0.224552, 0, 0.112359, 0.0725103, 0.197477, 0.069267, 0.169833, 0.0726778, 0.0832014, 0.009734, 0.182127, 0.244249, 0.559457, 0.208788, 0.0954913, 0.327554, 0.903809, 0.912053, 0.547483, 0.37276, 0.265602, 0.199792, 0.160322, 0.170121, 0.256531, 0.996908, 0.385772, 0.743707, 0.436061, 1.00953, 0.844883, 0.4896, 0.528627, 0.61281, 0.416287, 0.609695, 1.56453, 1.33367, 1.61417, 1.85013, 2.16463, 1.54477, 1.20897, 1.99911, 2.03864, 1.64286, 2.74959, 2.35276, 2.44443, 4.6018, 2.68767, 4.72511, 1.85701, 4.45601, 3.23588, 5.55652, 6.24686, 6.71558, 7.0008, 7.60255, 8.53363, 9.75051, 11.8958, 12.416, 16.1937, 20.469, 22.8086, 30.3448, 38.1743, 46.4651, 60.5535, 95.5283, 124.944, 176.323, 241.645, 338.318, 462.846, 598.915, 786.348, 980.078, 1174.59, 1390.05, 1566.46, 1670, 1699.45, 1650.07, 1520.02, 1389.12, 1199.14, 994.767, 810.746, 604.977, 443.414, 356.432, 290.282, 189.145, 136.065, 99.0106, 79.0958, 46.6645, 33.4707, 25.8581, 17.9975, 14.8672, 9.31015, 8.34487, 5.15488, 5.05244, 2.92597, 1.54064, 1.83539, 1.64404, 1.16403, 1.23194, 0.806798, 0.335951, 0.683143, 0.565032, 2.4175, 0.74652, 0.0778261, 0.102391, 0.00976989, 0.00340985, 0.00776641, 0.13907, 0.173109, 0.0476013, 0, 0, 0.514918, 0, 0.0426534, 0, 0, 0.0797696, 0, 0, 0, 0, 0, 0, 0.000127528, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

    // bin 24
    vector<float> Z_METl_large{0.115933, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0111551, 0.00637909, 0, 0, 0, 0, 0, 0, 0, 0, 0.00490038, 0, 0, 0.00486282, 0, 0, 0.00595867, 0, 0, 0, 0, 0, 0, 0, 0.00267939, 0, 0, 0, 0, 0, 0, 0.00549322, 0.00228507, 0, 0, 0.00512707, 0, 0.0134339, 0, 0, 0, 0, 0, 0, 0, 0.000106536, 0, 0.00591819, 0.00802816, 0, 0, 0, 0, 0, 0, 0, 0.0296909, 0.0130288, 0.0057244, 0, 0.0062627, 0.0236646, 0.00656654, 0, 0, 0.0362972, 0.00592709, 0.015657, 0.00665647, 0.0093714, 0.000835756, 0, 1.18967e-08, 0.0292343, 0, 0, 0, 0.00518777, 0.00457013, 0.00530138, 0, 0.0100102, 0, 0, 0, 0, 0.00940043, 0, 0.00500958, 0.00433959, 0.00729918, 0, 0.0016456, 0.0111646, 0.00565785, 0.0294745, 0.0024097, 0.00621901, 0.00601403, 0.116407, 0.00166868, 0.00969771, 0, 0.00302868, 0.0094932, 0.0222658, 0.0344137, 0.0280446, 0, 0.00763415, 0.00585562, 0.044247, 0.120377, 0.0162142, 0, 0.0459991, 0, 0.010775, 0.049512, 0.0191276, 0.00775893, 0.0417972, 0.0105216, 0.0325476, 0.0282313, 0.109187, 0.0472242, 0.0557108, 0.0222914, 0.0658027, 0.022054, 0.0198629, 0.124418, 0.0580393, 0.0646997, 0.029809, 0.02661, 0.0105799, 0.0709561, 0.0490596, 0.0735978, 0.0658827, 0.031916, 0.0749501, 0.087576, 0.0389786, 0.09468, 0.128873, 0.0685526, 0.197696, 0.100454, 0.0791846, 0.0730607, 0.0888807, 0.0863315, 0.210929, 0.0874596, 0.14192, 0.0968021, 0.244821, 0.0628502, 0.116443, 0.159137, 0, 0.18811, 0.224158, 0.298748, 0.189265, 0.204698, 0.201421, 0.257168, 0.236731, 0.20953, 0.186222, 0.288638, 0.498364, 0.177952, 0.311275, 0.139289, 0.432856, 0.432213, 0.332833, 0.421262, 0.555283, 0.322317, 0.663448, 0.668257, 0.794271, 0.468868, 0.7079, 0.599777, 0.665512, 0.695427, 0.88697, 0.829123, 0.815691, 0.647393, 0.980058, 0.694687, 0.789977, 0.855972, 0.765679, 0.917282, 0.787975, 0.803, 0.788058, 0.796516, 1.07349, 0.917291, 0.888697, 0.960691, 0.711246, 0.983569, 0.782572, 0.751992, 0.536461, 0.7207, 0.541025, 0.716935, 0.514492, 0.519986, 0.6034, 0.373292, 0.398529, 0.505707, 0.424331, 0.337762, 0.400449, 0.26422, 0.247087, 0.203503, 0.365729, 0.156984, 0.151905, 0.119207, 0.151549, 0.0955492, 0.115552, 0.0647861, 0.0794162, 0.09883, 0.0803807, 0.13313, 0.0321786, 0.079164, 0.0761891, 0.0237256, 0.0740003, 0.0196346, 0.0538495, 0.0402904, 0.0179348, 0.014763, 0.0148837, 0.0326713, 0.0136739, 0.0057919, 0.0288432, 0.0195036, 0.00617222, 0.0368335, 0.0110126, 0.00409644, 0.0162334, 0.00755637, 0.00747496, 0, 0, 0.00540113, 0.00470823, 0.00521604, 0.00574338, 0.00480483, 0.00633498, 0.0128964, 0, 0, 0, 0, 0, 0.00462825, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0004414, 0, 0, 0, 0, 0, 0.0112602, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    vector<float> g_METl_large{-0.00281107, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00245453, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.38632e-06, 0.00157805, 0, 0, 0, 0, 0.00239578, 0.00659907, 0, 0, 0.0034608, 0, 0, 0, 0, 0, 0.000596672, 0, 0, 0, 0, 0.00288617, 0.00290543, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000937895, 0, 0, 0, 0, 0, 0, 0, 0, 4.78301e-05, 0, 0, 0, 0, 0, 0.0430584, 0, 0, 0.0179651, 0, 0.00281049, 0.00377186, 0, 0.000474013, 0, 0.00852976, 0.00120197, 0, 0, 0.00248324, 0.00266216, 0, 0.00727674, 0.00580145, 0.00523839, 0.00289692, 0, 0, 0, 0, 0.000646357, 0.000334693, 0.067144, 0.00422186, 0.00567941, 0.00691616, 0.00368115, 0.00624887, 0.00286523, 0, 0.00306915, 0.00861586, 0.000328941, 0.0154656, 0.0112725, 0.00397843, 0.0144994, 0.00258619, 0.0042162, 0.00484565, 0.0105888, 0.026362, 0.00850642, 0.00638593, 0.0109447, 0.0124598, 0.0191173, 0.00947422, 0.0178624, 0.0234034, 0.00678902, 0.0137823, 0.00145057, 0.0225182, 0.029299, 0.00801842, 0.0114227, 0.0306808, 0.0110931, 0.518407, 0.0227679, 0.0169157, 0.014745, 0.00730474, 0.0293032, 0.0310091, 0.0205973, 0.0544045, 0.0323431, 0.0402075, 0.112847, 0.0108178, 0.0332988, 0.177384, 0.0609728, 0.215983, 0.0536253, 0.0740707, 0.0660702, 0.0579607, 0.0496943, 0.133815, 0.100904, 0.0566791, 0.13072, 0.103702, 0.010331, 0.148062, 0.117457, 0.0986215, 0.168732, 0.203818, 0.109692, 0.366248, 0.196034, 0.0929791, 0.136783, 0.157315, 0.279977, 0.203844, 0.219035, 0.143442, 0.244512, 0.267427, 0.31893, 0.315261, 0.262784, 0.376724, 0.339784, 0.370324, 0.340015, 0.37752, 0.343657, 0.500922, 0.538262, 0.679311, 0.559273, 0.641318, 0.652733, 0.725003, 0.729025, 0.975313, 1.32816, 1.32204, 1.53552, 1.91993, 2.4265, 2.74729, 3.53707, 4.93664, 6.76574, 5.89345, 10.1898, 12.6507, 16.4018, 20.2275, 25.2034, 31.4745, 35.4064, 43.9244, 50.8229, 56.7086, 64.9547, 67.9082, 68.4413, 70.6307, 98.7272, 67.4518, 63.3349, 59.5729, 52.5749, 46.7447, 41.0075, 34.4714, 27.5792, 45.8734, 19.3742, 14.0797, 11.8091, 11.2552, 7.60569, 7.78364, 5.03337, 3.60821, 2.64877, 2.0272, 1.43384, 1.70306, 1.08272, 0.834167, 0.879511, 0.52925, 0.351989, 0.283445, 0.304612, 0.183684, 0.200734, 0.207212, 0.098532, 0.105866, 0.0797948, 0.0751161, 0.0436117, 0.104856, 0.0519544, 0.0385219, 0.0241466, 0.0402365, 0.0458996, 0.00587601, 0.0157699, 0.00247901, 0.00552237, 0.000767513, 0.00572745, 0.00647023, 0.0761973, 0, 0.00594876, 0, 0.00719493, 0.00493038, 0, 0, 0, 0.00299884, 0.00396515, 0, 0, 0.00328131, 0, 0, 0, 0.00280193, 0, 0, 0, 0, 0, 0, 0.00394633, 0, 0.00197047, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

    //--- Rebin
    int n_large_bins = 501;
    int n_bins = 50;

    vector<float> Z_METl;
    vector<float> g_METl;

    TH1D* hist_z_metl = new TH1D("hist_z_metl","",n_bins,-1000,1000);
    TH1D* hist_g_metl = new TH1D("hist_g_metl","",n_bins,-1000,1000);
    for (int bin=0; bin<n_bins; bin++) {
        int matching_bin = int(n_large_bins-n_bins)/2+bin;
        Z_METl.push_back(Z_METl_large[matching_bin]);
        g_METl.push_back(g_METl_large[matching_bin]);
        hist_z_metl->SetBinContent(bin, Z_METl[bin]);
        hist_g_metl->SetBinContent(bin, g_METl[bin]);
    }

    //--- Plot METl distributions
    hist_z_metl->SetLineColor(kRed); hist_g_metl->SetLineColor(kBlue);
    float SF = hist_z_metl->Integral() / hist_g_metl->Integral();
    hist_g_metl->Scale(SF);

    hist_z_metl->Draw();
    hist_g_metl->Draw("samehist");
    TLegend* leg = new TLegend(0.6,0.7,0.88,0.88);
    leg->AddEntry(hist_z_metl, "Z+jets", "f");
    leg->AddEntry(hist_g_metl, "#gamma+jets", "f");
    leg->SetBorderSize(0);
    leg->SetFillColor(0);
    leg->Draw();

    //--- Deconvolve and plot
    TSpectrum deconv_tool;
    Double_t *z_metl_deconv = new Double_t[n_bins]; // pointer for passing to TSpectrum
    Double_t g_metl_deconv[n_bins];
    for (int i=0; i<n_bins; i++) {
        z_metl_deconv[i] = Z_METl[i];
        g_metl_deconv[i] = g_METl[i];
        if (i>n_bins/2) g_metl_deconv[i] = 0;
    }
    deconv_tool.Deconvolution(z_metl_deconv, g_metl_deconv, n_bins, 1000, 1, 1.0);
    TH1D *hist_z_metl_deconv = new TH1D("hist_z_metl_deconv","",n_bins,-1000,1000);
    for (int i=0; i<n_bins; i++) {
        hist_z_metl_deconv->SetBinContent(i, z_metl_deconv[i]);
    }

    hist_z_metl_deconv->SetLineColor(kRed);
    hist_z_metl_deconv->Draw();

    //--- Sample randomly
    TH1D *hist_g_metl_smeared = new TH1D("hist_g_metl_smeared","",n_bins,-1000,1000);
    for (int i=0; i<10000; i++) {
        float smeared_g_metl = hist_g_metl->GetRandom() - hist_z_metl_deconv->GetRandom();
        hist_g_metl_smeared->Fill(smeared_g_metl);
    }

    hist_z_metl->SetLineColor(kRed); hist_g_metl_smeared->SetLineColor(kBlue);
    SF = hist_z_metl->Integral() / hist_g_metl_smeared->Integral();
    hist_g_metl_smeared->Scale(SF);

    hist_z_metl->Draw();
    hist_g_metl_smeared->Draw("samehist");
    leg = new TLegend(0.6,0.7,0.88,0.88);
    leg->AddEntry(hist_z_metl, "Z+jets", "f");
    leg->AddEntry(hist_g_metl, "#gamma+jets (Smeared)", "f");
    leg->SetBorderSize(0);
    leg->SetFillColor(0);
    leg->Draw();
}
